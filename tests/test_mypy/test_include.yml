- case: include_removes_optional
  main: |
    from prisma import Client

    async def main() -> None:
      client = Client()

      user = await client.user.find_unique({'id': '1'}, include={'posts': True})
      if user is not None:
        reveal_type(user.posts)  # N: Revealed type is 'builtins.list[prisma.models.Post]'
        if len(user.posts) == 0:
          print('user does not have any posts!')
        else:
          print('user has at least one post')

        reveal_type(user.profile)  # N: Revealed type is 'Union[prisma.models.Profile, None]'

      user = await client.user.find_unique(include={'posts': True}, where={'id': '1'})
      if user is not None:
        reveal_type(user.posts)  # N: Revealed type is 'builtins.list[prisma.models.Post]'

      user = await client.user.find_unique({'id': '1'}, {'posts': True})
      if user is not None:
        reveal_type(user.posts)  # N: Revealed type is 'builtins.list[prisma.models.Post]'

      user = await client.user.find_unique({'id': '1'}, dict(posts=True))
      if user is not None:
        reveal_type(user.posts)  # N: Revealed type is 'builtins.list[prisma.models.Post]'

      user = await client.user.find_unique({'id': '1'}, include={'posts': True, 'profile': True})
      if user is not None:
        reveal_type(user.posts)  # N: Revealed type is 'builtins.list[prisma.models.Post]'

        # profile is still optional as it is optional on a database level
        reveal_type(user.profile)  # N: Revealed type is 'Union[prisma.models.Profile, None]'

      user = await client.user.find_unique({'id': '1'}, include={'posts': False})
      if user is not None:
        reveal_type(user.posts)  # N: Revealed type is 'Union[builtins.list[prisma.models.Post], None]'
        reveal_type(user.profile)  # N: Revealed type is 'Union[prisma.models.Profile, None]'

      user = await client.user.find_unique({'id': '1'})
      if user is not None:
        reveal_type(user.posts)  # N: Revealed type is 'Union[builtins.list[prisma.models.Post], None]'
        reveal_type(user.profile)  # N: Revealed type is 'Union[prisma.models.Profile, None]'
